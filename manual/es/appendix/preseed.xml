<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- original version: 39285  -->
<!-- traducido por jfs, 30 dic 2005 -->

<!--
Tened cuidado con el formato de este fichero dado que se parsea
para generar el fichero de preconfiguración.

En ese fichero se incluye todo el texto dentro de marcas
<informalexample> que tienen el atributo 'role="example"'. 
Salvo si hay un atributo 'condition' que hace que no aplique a 
la versión específica o un atributo 'arch' que hace que no aplique
a una arquitectura específica.

Actualmente sólo se genera una variante del fichero de ejemplo (para i386).
-->

<appendix id="appendix-preseed">
<title>Instalar automáticamente utilizando preconfiguración</title>

<para>

Este apéndice explica los detalles de preconfigurar respuesas a preguntas
en &d-i;  para poder así automatizar una instalación.

</para><para>

Los fragmentos de configuración que se utilizan en este apéndice están también
disponibles como un fichero de preconfiguración de ejemplo en
&urlset-example-preseed;.

</para>

 <sect1 id="preseed-intro">
 <title>Introducción</title>
<para>

La preconfiguración ofrece un mecanismo para responder a preguntas realizadas
durante la instalación sin tener que introducir manualmente las respuestas
mientras ésta se ejecuta.
Esto hace posible que se automatizen la mayoría de las instalaciones e incluso
ofrece funcionalidades que no están disponibles durante una instalación normal.

</para>

  <sect2 id="preseed-methods">
  <title>Métodos de preconfiguración</title>
<para>

Se pueden utilizar tres métodos de preconfiguración:
<firstterm>initrd</firstterm>, <firstterm>file</firstterm> (fichero, n. del t.)
y <firstterm>network</firstterm> (red, n. del t.). La preconfiguración a través
de initrd funciona en cualquier método de instalación y permite preconfigurar
más cosas, pero es la que más preparación requiere. Los metodos de
preconfiguración con fichero o vía red pueden utilizarse en distintos métodos
de instalación. No se pueden preconfigurar las primeras preguntas de la
instalación tanto en el caso de la precofinguración a través fichero o vía red
dado que sólo se cargan una vez se han preguntado.

</para><para>

La siguiente tabla muestra los métodos de preconfiguración que pueden utilizarse
con los distintos métodos de instalación.

<informaltable>
<tgroup cols="4">
<thead>
<row>
  <entry>Método de instalación</entry><entry>initrd</entry>
  <entry>file</entry><entry>network</entry>
</row>
</thead>

<tbody>
<row>
  <entry>CD/DVD</entry>
  <entry>sí</entry>
  <entry>sí</entry>
  <entry>no</entry>
</row><row>
  <entry>netboot</entry>
  <entry>sí</entry>
  <entry>no</entry>
  <entry>sí</entry>
</row><row>
  <entry>hd-media <phrase condition="bootable-usb">(incluyendo memorias usb)</phrase></entry>
  <entry>sí</entry>
  <entry>sí</entry>
  <entry>no</entry>
</row><row condition="supports-floppy-boot">
  <entry>basado en disquete (controladores de cd)</entry>
  <entry>sí</entry>
  <entry>sí</entry>
  <entry>no</entry>
</row><row condition="supports-floppy-boot">
  <entry>basado en disquete (controladores de red)</entry>
  <entry>sí</entry>
  <entry>no</entry>
  <entry>sí</entry>
</row><row arch="s390">
  <entry>genérico/cinta</entry>
  <entry>sí</entry>
  <entry>no</entry>
  <entry>sí</entry>
</row>
</tbody>

</tgroup></informaltable>

</para><para>

Una diferencia importante entre los métodos de preconfiguración es el punto en
el que se carga y procesa el fichero de preconfiguracio. Para la
preconfiguración a través del initrd ésto se produce justo al comienzo de la
instalación, antes de hacer siquiera la primera pregunta. Para la
preconfiguración con fichero ésto se hace después de que el CD o la imagen de
CD se haya cargado. Para la preconfiguración de red ésto se hace sólo después
de que se haya configurado la red.

</para><para>

En términos prácticos esto significa que en la preconfiguración por fichero y
vía red ya se habrá tenido que responder a las preguntas sobre idioma, país y
seleccio de teclado. Además, para la preconfiguración vía red, se habrán
respondido  todas las preguntas relacionadas con la configuración de red.
Algunas preguntas que sólo se muestra en prioridad media o baja (como el primer
intento de detección automática de hardware) también se habrán respondido en
este caso.

</para><para>

Obviamente, cualquier pregunta que se haya procesado antes de cargar el
fichero de preconfiguración no puede preconfigurarse.
Puede encontrar una forma para evitar que se omitan estas preguntas con
<xref linkend="preseed-bootparms"/>.

</para>
  </sect2>

  <sect2 id="preseed-limitations">
  <title>Limitaciones</title>
<para>

Aunque la mayoría de las preguntas que utiliza &d-i; pueden preconfigurarse
con este mecanismo hay algunas excepciones importantes. Tiene que (re)particionar
el disco completo o utilizar el espacio en disco libre disponible, no puede usar
particiones existentes. Tampoco puede aún utilizar la preconfiguración para 
configurar RAID.

</para>
  </sect2>

<!-- Joeyh feels this is too technical, so leave it out for now
  <sect2 id="preseed-debconf">
  <title>Información básica de Debconf</title>
<para>

Preseeding makes use of the <classname>debconf</classname> framework. This
framework is the preferred mechanism used in Debian to interact with the user
when configuring packages and also forms the heart of &d-i;.
In the <classname>debconf</classname> framework questions or dialogs are
based on <firstterm>templates</firstterm>. There are different types of
templates for different types of questions. The actual questions are
<quote>generated</quote> from templates at runtime;  multiple questions can
use the same template.

</para><para>

The following types of templates are relevant for preseeding.

</para>

<itemizedlist>
<listitem><para>
  string: allows the user to type any value
</para></listitem>
<listitem><para>
  password: similar to string but the value typed is not displayed
</para></listitem>
<listitem><para>
  boolean: for yes/no or true/false type of questions
</para></listitem>
<listitem><para>
  select: allows the user to select one option from a list
</para></listitem>
<listitem><para>
  multiselect: allows the user to select zero, one or more options from a list
</para></listitem>
<listitem><para>
  note: used to display a message
</para></listitem>
</itemizedlist>

<para>

In &d-i; templates are stored in a readable file
<filename>/var/cache/debconf/templates.dat</filename>. This file contains all fixed
text and all translations. It can also contain a default value for the
template. The fixed text can include variables that will be replaced at
runtime.

</para><para>

Another readable file <filename>/var/cache/debconf/questions.dat</filename>
is used to store the values for variables and the answers given to questions.
A question always refers to the template used to ask it. For obvious
security reasons the values for questions of type <quote>password</quote>
are stored in a separate, non-readable file in the same directory.

</para>
  </sect2>
-->

  <sect2 id="preseed-hooks">
  <title>Ejecución de órdenes a medida durante la instalación</title>
<para>

Una opcio muy poderosa y flexible que ofrecen las herramientas de preconfiguración
es la capacidad de ejecutar órdenes o guiones en puntos específicos de la instalación.
Tiene más detalles en <xref linkend="preseed-shell"/>.

</para>

<itemizedlist>
<listitem><para>
  <userinput>preseed/early_command</userinput>: se procesa tan pronto como se haya
  cargado el fichero de preconfiguración.
</para></listitem>
<listitem><para>
  <userinput>preseed/late_command</userinput>: se procesa justo antes del reinicio
  del equipo al final de la instalación pero antes de que
  se desmonte el sistema de ficheros <filename>/target</filename>.
</para></listitem>
</itemizedlist>

  </sect2>

  <sect2 id="preseed-seenflag">
  <title>Utilizar la preconfiguración para cambiar los valore por omisión</title>
<para>

Es posible utilizar la preconfiguración para cambiar las respuestas por omisión
a una pregunta, pero haciendo que esta pregunta se realice. Para hacer ésto
debe definirse la marca <firstterm>seen</firstterm> (visto, n. del t.) a
<quote>false</quote> una vez se ha fijado un valor para la pregunta.

</para>

<informalexample><screen>
d-i foo/bar string value
d-i foo/bar seen false
</screen></informalexample>

  </sect2>
 </sect1>

 <sect1 id="preseed-using">
 <title>Utilizar la preconfiguración</title>
<para>

Por supuesto, en primer lugar ha de crear primero el fichero de preconfiguración
y ponerlo en la localización donde pretende utilizarlo. La creación del fichero
de preconfiguración se describe más adelante en este apéndice. Colocar el
fichero en la ubicación correcta es algo relativamente sencillo para la
preconfiguración vía red o si quiere leer el fichero de un disquete o una
memoria usb. Si desea incluir el fichero en un CD o DVD tendrá que rehacer la
imagen ISO. La inclusión del fichero de preconfiguración en el initrd queda
fuera del alcance de este documento, consulte la documentación de
desarrolladores de &d-i; si está interesado.

</para><para>

Tiene un fichero de preconfiguración de ejemplo, que puede utilizar como base
para su propio fichero de preconfiguración, en &urlset-example-preseed;. Este
fichero está basado en fragmentos de configuración incluídos en este apéndice.

</para>

  <sect2 id="preseed-loading">
  <title>Cargar el fichero de preconfiguración</title>
<para>

Si está utilizando la preconfiguración por initrd tiene que asegurarse que
existe un fichero con el nombre de <filename>preseed.cfg</filename> en el
directorio raíz del initrd. El instalador buscará automáticamente este fichero
y lo cargará.

</para><para>

Para otros métodos de preconfiguración tiene que decirle al instalador qué
ficheros utilizar cuando se arranca. Ésto se hace habitualmente dando un valor al parámetro
de arranque del núcleo, bien manualmente en el arranque o bien editando el
fichero de configuración del cargador de arranque (p.ej.
<filename>syslinux.cfg</filename>) y añadiendo el parámetro al final de la/s
línea/s <quote>append</quote> para el núcleo.

</para><para>

Si especifica un fichero de preconfiguración en la configuración del cargador
de arranque podrá cambiar la configuración para que no tenga que pulsar enter
en el arranque del instalador. En el caso de syslinux esto signfica que
tiene que poner el valor de <quote>timeout</quote> en
<filename>syslinux.cfg</filename> a <literal>1</literal>.

</para><para>

Para asegurarse de que el instalador obtiene el fichero de preconfiguración
correcto puede especificar (opcionalmente) una marca identificativa para el
fichero. Esta marca es actualmente una suma MD5 y, si se especifica, debe
coincidir el valor que se obtenga del fichero de preconfiguración o el
instalador se negará a utilizarlo.

</para>

<informalexample><screen>
Párametros de arranque a especificar:
- si está arrancando de red:
  preseed/url=http://host/path/to/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d

- si está arrancando de un CD remasterizado:
  preseed/file=/cdrom/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

- si está instalando de un medio USB (ponga el fichero de preconfiguración
  en el directorio principal de la memoria USB):
  preseed/file=/hd-media/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d
</screen></informalexample>

<para>

Tenga en cuenta que puede abreviar <filename>preseed/url</filename> a
<filename>url</filename> y <filename>preseed/file</filename> a
<filename>file</filename> cuando se pasan como parámetros al núcleo.

</para><para>

Cuando haga esto puede quere añadir el parámetro
<userinput>priority=critical</userinput> en el arranque. Esto impedirá
que se haga ninguna pregunta aunque la preconfiguración mostrada más abajo no
responda a alguna.

</para>
  </sect2>


 <sect2 id="preseed-dhcp">
 <title>Utilizar un servidor DHCP para especificar los ficheros de preconfiguración</title>
<para>

También es posible utilizar DHCP para especificar un fichero de preconfiguración
que se debe descargar de la red. El protocolo DHCP permite especificar
un archivo. Generalmente este es un archivo para el arranque en red,
pero si parece ser un URL entonces el medio de instalación que soporte
preconfiguración vía red descargará un fichero de la URL y lo utilizará
como un fichero de preconfiguración. A continuación se muestra un ejemplo
de cómo configurar el dhcp.conf de la versión 3 del servidor de DHCP de
ISC (el paquete Debian dhcp3-server).
</para>

<informalexample><screen>
if substring (option vendor-class-identifier, 0, 3) = "d-i" {
    filename "http://servidor/preconfiguracion.cfg";
}
</screen></informalexample>

<para>

Tenga en cuenta que el ejemplo anterior limita la entrega de este nombre
de fichero a clientes DHCP que se idenfiquen como «d-i». De esta forma
no se afectará a clientes DHCP normales sino sólo al instalador. También
puede poner ese texto en la definición de un sistema específico para
evitar preconfigurar todas las instalaciones que se hagan en su red.

</para><para>

Una buena forma de hacer uso de la preconfiguración de DHCP es sólo
preconfigurar los valores específicos a su red, como puedan ser la 
réplica Debian a utilizar. De esta forma todas las instalaciones en su
red cogerán automáticamente la réplica adecuada, mientras que el resto
de la instalación se realizará de forma interactiva. Deberá tener
cuidado si quiere utilizar preconfiguración DHCP para automatizar 
la instalación completa de Debian.

</para>
  </sect2>


  <sect2 id="preseed-bootparms">
  <title>Utilizar parámetros de arranque para complementar la preconfiguración</title>
<para>

Hay algunas partes del proceso de instalación que no pueden automatizarse con
algunos métodos de preconfiguración porque las preguntas se responden antes de
que se cargue el fichero de preconfiguración. Por ejemplo, será necesario
configurar primero la red si el fichero de preconfiguración se descarga de
ésta.  Una razón para utilizar la preconfiguración de initrd es que permite la
preconfiguración incluso en estas etapas iniciales del proceso de instalación.

</para><para>

La instalación puede automatizarse por completo aún cuando  el fichero de
preconfiguración no puede utilizarse para preconfigurara ya que se pueden dar
valores de preconfiguración al núcleo en la línea de órdenes. Sólo es necesario
dar parámetros del tipo <userinput>ruta/a/variable=valor</userinput> para
cualquiera de las variables de preconfiguración que se detallan en los
ejemplos.
 	 
</para><para>

Tenga en cuenta que hay una abreviatura para las variables que se utilizan con
más frecuencia en el indicador de arranque. Los ejemplos de este apéndice
utilizan la abreviatura si hay una disponible en lugar de la variable completa.

</para><para>

Un <quote>--</quote> en las opciones de arranque tiene un 
significado especial. Los parámetros que aparezcan tras éste se copiarán
a la configuración del cargador de arranque que se instale (si el instalador
proporciona soporte para esa opción con el cargador de arranque
seleccionado). Tenga en cuenta que es posible que el caracter
<quote>--</quote> ya exista en los parámetros de arranque
por omisión.

</para>
<note><para>

El núcleo 2.4 acepta un máximo de ocho opciones en línea de órdenes y
ocho opciones de entorno (incluyendo las opciones que añade por omisio el
propio instalador). Si se excede esta cantidad los núcleos 2.4 descartarán las
opciones que lo sobrepasen y los núcleos 2.6 abortarán (con un
<quote>panic</quote>). Se pueden utilizar hasta treinta y dos opciones de línea
de órdenes y treinta y dos opciones de entorno en el caso de las versiones del
núcleo 2.6.9 y posteriores.

</para></note>
<para>

Para la mayoría de las instalaciones se pueden eliminar algunas de las opciones
del fichero de configuracio del cargado de arranque, como por ejemplo
<literal>vga=normal</literal> lo que permite añadir más opciones para la
preconfiguración.

</para>
<note><para>

No siempre es posible especificar valores con espacios para los parámetros
de arranque aunque se delimiten con comillas dobles.

</para></note>
  </sect2>
 </sect1>

 <sect1 id="preseed-creating">
 <title>Crear un fichero de preconfiguración</title>
<para>

El fichero de preconfiguración tiene el formato que utiliza la orden
<command>debconf-set-selections</command>.
El formato general para una línea del fichero de preconfiguración es:

<informalexample><screen>
&lt;propietario&gt; &lt;nombre de la pregunta&gt; &lt;tipo de pregunta&gt; &lt;valor&gt;
</screen></informalexample>

</para><para>

Existen algunas reglas a tener en cuenta cuando se escribe un fichero
de preconfiguración.


</para>

<itemizedlist>
<listitem><para>
  Sólo se permite un espacio entre tipo de plantilla y valor. Cualquier
  espacio adicional se considerará que pertenece al valor.
</para></listitem>
<listitem><para> 
 Se puede dividir una línea en múltiples líneas si se añade un barra invertida
 (<quote><literal>\</literal></quote>) como caracter de continuación de línea.
 Un buen punto para la divisón de la linea es después del nombre de la
 pregunta. Es mala idea dividir la línea entre el tipo y el valor.
 </para></listitem>
 <listitem><para>
  La mayoría de las preguntas tienen que preconfigurarse con los
  valores que sean válidos en inglés y no en las traducciones de esos mismos
  valores. Hay algunas preguntas, sin embargo (como es el caso de 
  <classname>partman</classname>) donde se tienen que utilizar los valores
  traducidos.
 </para></listitem>
 <listitem><para>
  Algunas preguntas toman un código como valor en lugar del campo 
  de texto mostrado durante la instalación (en inglés).
 </para></listitem>
</itemizedlist>

<para>

La forma más sencilla para crear un fichero de configuración es utilizar
como base el ejemplo enlazado en <xref linkend="preseed-contents"/> y
trabajar a partir de ahí.

</para><para>

Un método alternativo es realizar una instalación manual y, tras el
rearranque, utilizar <command>debconf-get-selections</command>, disponible
en el paquete <classname>debconf-utils</classname>, para volcar
la base de datos de debconf y la base de datos cdebconf del instalador en un sólo fichero.

<informalexample><screen>
$ debconf-get-selections --installer &gt; <replaceable>fichero</replaceable>
$ debconf-get-selections &gt;&gt; <replaceable>fichero</replaceable>
</screen></informalexample>

</para><para>

Sin embargo, un fichero generado de esta forma tendrá algunos elementos que no
deberían preconfigurarse. Lo recomendable para la mayoría de los usuarios es
empezar con el fichero de ejemplo.

</para>

<note><para>

Este método se basa en el hecho de que al final de la instalación
la base de datos «cdebconf» del instalador se guarda en el sistema instalado en
<filename>/var/log/installer/cdebconf</filename>. Dado que esta base de datos
puede conetener información sensible sólo la puede leer, por omisión, el
superusuario.

</para><para>

Si purga el paquete 
<classname>installation-report</classname> se eliminará el directorio
<filename>/var/log/installer</filename> y todos los ficheros en él
incluidos de su sistema.

</para></note>

<para>

Puede utilizar <command>nano</command> para comprobar los posibles
valores de las preguntas, examinando los ficheros en <filename>/var/lib/cdebconf</filename> durante una instalación que está en progreso. Consulte
<filename>templates.dat</filename> si quiere las plantillas en crudo
o <filename>questions.dat</filename> si quiere consultar los valores
actuales y asignados a las variables.

</para><para>


Para comprobar si el formato de su fichero de preconfiguración es válido
antes de hacer una instalación puede utilizar la orden
<command>debconf-set-selections -c <replaceable>preseed.cfg</replaceable></command>.

</para>
 </sect1>

 <sect1 id="preseed-contents">
 <title>Contenidos del fichero de preconfiguración</title>
<para>

Los fragmentos de configuración que se utilizan en este apéndice también están
disponible como un ejemplo de fichero de preconfiguración en 
&urlset-example-preseed;.

</para><para>

Tenga en cuenta que este ejemplo está basado en una instalación para la
arquitectura Intel x86. Si está instalando en otra arquitectura no serán
relevantes algunos de los ejemplos (como la seleccio de teclado o la
instalación del cargador) y tendrá que reemplazarlos por los valores de debconf
más apropiados a su arquitectura.

</para>

  <sect2 id="preseed-l10n">
  <title>Localización</title>
<para>

La configuración de los valores de localización sólo funcionará si está
utilizando preconfiguración a través de initrd. Con cualquier otro método
el fichero de preconfiguración se cargará después de haber hecho estas preguntas.

</para><para>

<!-- N del T: En el texto original utiliza en_US, aquí cambiamos a es_ES -->
La localización puede utilizarse para espceificar tanto el idioma como el país.
Puede utilizar
<userinput>locale=<replaceable>es_ES</replaceable></userinput>.
para especificar la localización como un parámetro de arranque.

<informalexample role="example"><screen>
# Configuración de localización para el idioma y país.
d-i debian-installer/locale string es_ES
</screen></informalexample>

</para><para>

La configuración del teclado consiste en la selección de una arquitectura
de teclado y un mapa de teclado. En la mayor parte de los casos se selecciona
una arquitectura de teclado correcta por omisión y no es necesario preconfigurarla.
El mapa de teclado debe ser válido para la arquitectura de teclado seleccionada.

<informalexample role="example"><screen>
# Selección de teclado
#d-i console-tools/archs select at
d-i console-keymaps-at/keymap select us
# Ejemplo de cómo configurar una arquitectura de teclado distinta
#d-i console-keymaps-usb/keymap select mac-usb-us
</screen></informalexample>

</para><para>

Para obviar la configuración de teclado preconfigure
<classname>console-tools/archs</classname> con
<userinput>skip-config</userinput>.
Esto hará que sea el mapa de teclado del núcleo el permanezca activo.

</para>

<note><para>

Los cambios en la capa de entrada para los núcleos 2.6 han hecho que la
arquitectura de teclado esté practicamente obsoleta. En el caso de los núcleos
2.6 debería seleccionarse generalmente un mapa de teclado <quote>PC</quote>
(<userinput>at</userinput>).

</para></note>
  </sect2>

  <sect2 id="preseed-network">
  <title>Configuración de red</title>
<para>

Por supuesto, no funcionará la preconfiguración de la tarjeta de red si está
obteniendo el fichero de preconfiguración de la red. Pero esta opción es muy
cómoda cuando está arrancando de un CD o memoria USB. Si carga ficheros de
preconfiguración de la red puede dar los parámetros de configuración de la red
a través de parámetro de arranque del núcleo.

</para><para>

Tiene que utilizar un parámetro de arranque similar a
<userinput>interface=<replaceable>eth1</replaceable></userinput>
si tiene que escoger un interfaz particular durante el arranque vía red antes
de cargar el fichero de preconfiguración de la red.

</para><para>

Aunque generalmente no es posible preconfigurar la red cuando se hace
preconfiguración de red (al utilizar <quote>preseed/url</quote>), puede
utilizar este truco para evitar ésto si, por ejemplo, quiere conifgurar una
dirección estática a la interfaz de red. El truco es obligar a que la
configuración de red se ejecute de nuevo después de haber cargado el fichero de
preconfiguración creando un programa <quote>preseed/run</quote> con las
siguientes líneas:

<informalexample><screen>
killall.sh dhclient
netcfg
</screen></informalexample>

</para>

<informalexample role="example"><screen>
# netcfg escojerá el interfaz que tiene enlace si puede. Esto hace que no
# muestre la lista si hay más de uno.
d-i netcfg/choose_interface select auto

# Si tiene un servidor de DHCP lento y el instalador expira intentando
# conectarse a él, ésto puede serle útil.
#d-i netcfg/dhcp_timeout string 60

# Escoger una interfaz específica en lugar de la encontrada:
#d-i netcfg/choose_interface select eth1

# Así es como puede configurar la red manualmente descomentando esta línea
# y las líneas de configuración estática de red a continuación.
#d-i netcfg/disable_dhcp boolean true

# Si quiere que el fichero de preconfiguración funcione tanto en
# sistemas con un servidor de DHCP como en los que no lo tengan, tendrá
# que descomentar estas líneas y añadir la configuración estática de red
# a continuación.
#d-i netcfg/dhcp_failed note
#d-i netcfg/dhcp_options select Configure network manually

# Configuración estática de red
#d-i netcfg/get_nameservers string 192.168.1.1
#d-i netcfg/get_ipaddress string 192.168.1.42
#d-i netcfg/get_netmask string 255.255.255.0
#d-i netcfg/get_gateway string 192.168.1.1
#d-i netcfg/confirm_static boolean true

# Cualquier nombre de host y de dominio que se obtengan por DHCP se utilizan
# antes que los valores aquí definidos. Sin embargo, definir los valores evita
# que la pregunta se muestre aunque los valores vengan del DHCP.
d-i netcfg/get_hostname string unassigned-hostname
d-i netcfg/get_domain string unassigned-domain

# Deshabilitar el molesto mensaje sobre la clave WEP
d-i netcfg/wireless_wep string
# El nombre de servidor raro que algunos ISP utilizan como una especie de contraseña
#d-i netcfg/dhcp_hostname string radish
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-mirror">
  <title>Configuración de la réplica</title>
<para>

Dependiendo del método de instalación que uitlice se utilizará una
réplica tanto para descargar componentes adicionales del instalador
como para descargar el sistema base y para configurar
<filename>/etc/apt/sources.list</filename> en el sistema instalado.


</para><para>

El parámetro <classname>mirror/suite</classname> determina la versión
(<quote>suite</quote>, n. del t.) que utiliza el sistema instalado.

</para><para>

El parámetro <classname>mirror/udeb/suite</classname> determina la
<quote>suite</quote> de los componentes adicionales del
instalador. Sólo es necesario estabelecer este valor si se llegan a
descargar componentes a través de la red y debería coincidir con el
valor que se utilizó para construir el initrd para el método de
instalación utilizado. Por omisión, el valor de
<classname>mirror/udeb/suite</classname> es el mismo que el dado a
<classname>mirror/suite</classname>.

</para>

<informalexample role="example"><screen>
d-i mirror/country string enter information manually
d-i mirror/http/hostname string ftp.es.debian.org
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Versión a instalar.
#d-i mirror/suite string testing
# Versión a utilizar para descargar componentes de la instalación
# (opcional)
#d-i mirror/udeb/suite string testing
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-partman">
  <title>Particionado</title>
<para>

La utilización de la preconfiguración para particionar el disco duro
está limitada a lo que <classname>partman-auto</classname> pueda
permitir. Puede elegir o bien particionar el espacio libre en el disco
o todo el disco. La distribución del disco puede basarse en una receta
existente o utilizar una receta de un fichero o una receta incluída en
el fichero de preconfiguración. Actualmente no es posible utilizar la
preconfiguración para particionar más de un disco o para configurar
el RAID.

</para>

<warning><para>

La identificación de los discos depende del order en el que se
cargaron las unidades. Asegúrese de utilizar el disco correcto antes
de configurarlo si el sistema tiene más de un disco.

</para></warning>

<informalexample role="example"><screen>
# Si el sistema tiene espacio libre puede elegir particionar solamente
# este espacio.
# Nota: esta pregunta tiene que ser preconfigurada con el valor localizado
# (traducido)
#d-i partman-auto/init_automatically_partition \
#    select Use the largest continuous free space
#
# También puede especificar un disco a particionar. El nombre del
# dispositivo se puede introducir tanto en formato tradicional o en
# formato devfs.
#  Por ejemplo, puede utilizar este valor para usar el primer disco devfs:
d-i partman-auto/disk string /dev/discs/disc0/disc
# O, si quiere utilizar LVM:
#d-i partman-auto-lvm/disk string /dev/discs/disc0/disc

# Puede elegir cualquiera de las recetas de particionado predefinidas.
# Nota: esta plantilla tiene que ser preconfigurada con el valor localizado
# (traducido)
d-i partman-auto/choose_recipe \
       select All files in one partition (recommended for new users)
#d-i partman-auto/choose_recipe \
#       select Separate /home partition
#d-i partman-auto/choose_recipe \
#       select Separate /home, /usr, /var, and /tmp partitions

# O indicar su propia receta...
# El formato de las recetas está documentado en el fichero
# devel/partman-auto-recipe.txt.
# Si tiene una forma de colocar el fichero de receta dentro del entorno
# del d-i, simplemente puede direccionarlo a éste.
#d-i partman-auto/expert_recipe_file string /hd-media/recipe

# Si no, puede colocar la receta completa en una única línea
#(lógica). Este ejemplo crea una pequeña partición /boot, una
#partición de intercambio apropiada y usa el resto del espacio para
#la partición raíz:
#d-i partman-auto/expert_recipe string                         \
#      boot-root ::                                            \
#              40 50 100 ext3                                  \
#                      $primary{ } $bootable{ }                \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ /boot }                     \
#              .                                               \
#              500 10000 1000000000 ext3                       \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ / }                         \
#              .                                               \
#              64 512 300% linux-swap                          \
#                      method{ swap } format{ }                \
#              .

# La siguiente receta hace que «partman» particione automáticamente el
# espacio sin confirmación.
d-i partman/confirm_write_new_label boolean true
d-i partman/choose_partition \
       select Finish partitioning and write changes to disk
d-i partman/confirm boolean true
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-time">
  <title>Configuración del reloj y la zona horaria</title>

<informalexample role="example"><screen>
# Controla si el reloj de hardware está o no configurado a UTC 
# (Tiempo Universal Coordinado)
d-i clock-setup/utc boolean true

# Puede utilizar esta opción para definir un valor apropiado para $TZ.
# Consulte los valores permitidos en /usr/share/zoneinfo/ 
d-i time/zone string US/Eastern
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-apt">
  <title>Configuración de Apt</title>
<para>

Se configura automáticamente <filename>/etc/apt/sources.list</filename> basándose en
el método de instalación y las respuetas dadas anteriormente. También
se hace una configuración básica de éste. Las dos líneas mostradas
a continuación son relevantes para la preconfiguración. Desea ayudar
(opcionalmente) otras acciones del repositorio.

</para>

<informalexample role="example"><screen>
# Puede elegir instalar software de las fuentes «non-free» y «contrib».
#d-i apt-setup/non-free boolean true
#d-i apt-setup/contrib boolean true
# Descomente esta línea para impedir que los recursos de seguridad
# trabajen o me añadan un servidor distinto de security.debianorg.
#d-i apt-setup/security_host string

# Repositorios adicionales, se dispone de local[0-9]
#d-i apt-setup/local0/comment string local server
#d-i apt-setup/local0/source string \
#       deb http://local.server/debian stable main
# URL de la clave pública en el repositorio local.
#d-i apt-setup/local0/key string http://local.server/key
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-account">
  <title>Configuración de cuentas de usuario</title>
<para>

Puede preconfigurarse la contraseña para la cuenta del superusuario
(<quote>root</quote>) y el nombre y la contraseña de la primera cuenta
de usuario normal. Para las contaseñas se pueden utilizar tanto
<emphasis>hashes</emphasis> MD5 como valores en texto plano .

</para>
<warning><para>

Tenga en cuenta que la preconfiguración de la contraseña no es un
proceso seguro dado que cualquiera que pueda acceder a los ficheros de
preconfiguración podrá conocer las contraseñas. De cara a la seguridad
es un poco mejor la utilización de hashes MD5 pero también da un falso
sentido de la seguridad ya que el acceso al hash MD5 permite llevar a
cabo ataques de fuerza bruta sobre la contraseña.

</para></warning>

<informalexample role="example"><screen>
# No crear una cuenta de superusuario (la cuenta del usuario normal
# utilizar sudo).
#d-i passwd/root-login boolean false
# Igualmente, se puede omitir la creación de una cuenta de un usuario
# normal.
#d-i passwd/make-user boolean false

# Contraseña del superusuario, bien en texto en claro
#d-i passwd/root-password password r00tme
#d-i passwd/root-password-again password r00tme
# o cifrada utilizando un hash MD5
#d-i passwd/root-password-crypted password [MD5 hash]

# Para crear una cuenta de un usuario:
#d-i passwd/user-fullname string Debian User
#d-i passwd/username string debian
# Contraseña del usuario normal, bien en texto en claro:
#d-i passwd/user-password password insecure
#d-i passwd/user-password-again password insecure
# o cifrada utilizando un hash MD5.
#d-i passwd/user-password-crypted password [MD5 hash]
</screen></informalexample>

<para>

También se pueden preconfigurar las variables
<classname>passwd/root-password-crypted</classname> y
<classname>passwd/user-password-crypted</classname> utilizando como
valor <quote>!</quote>. Si hace esto para cualquiera de las dos
cuentas ésta se deshabilitará. Esto puede ser de ayuda para el caso de
la cuenta de superusuario, siempre que tenga un mecanismo alternativo
para poder llevar a cabo tareas de administración o acceder como
superusuario (como por ejemplo, la utilización de autenticación en SSH
mediante ficheros de clave pública o <command>sudo</command>).

</para><para>

Puede generar un hash MD5 para una contraseña con la siguiente orden:

<informalexample><screen>
$ echo "r00tme" | mkpasswd -s -H MD5
</screen></informalexample>

</para>
  </sect2>

  <sect2 id="preseed-base-installer">
  <title>Instalación del sistema base</title>
<para>

No hay mucho que pueda preconfigurarse para esta fase de la instalación.
Las únicas preguntas que se hacen son referentes a la instalación
del núcleo.

</para>

<informalexample role="example"><screen>
# Selecciona el generador initramfs para generar el «initrd» en
# núcleos 2.6
#d-i base-installer/kernel/linux/initramfs-generators string yaird
</screen></informalexample>

  </sect2>


  <sect2 id="preseed-bootloader">
  <title>Instalación del cargador de arranque</title>

<informalexample role="example"><screen>
# GRUB es el gestor de arranque predeterminado (para arquitectura x86).
# Descomente esta opción si quiere instalar lilo en su lugar:
#d-i grub-installer/skip boolean true

# Esta es una configuración adecuada y segura, hace que grub se instale
# automáticamente en el MBR si no se detecta otro sistema operativo en
# la máquina.
d-i grub-installer/only_debian boolean true

# Lo siguiente hace que el «grub-installer» instale en el MBR en caso de
# que se encuentre instalado otro sistema operativo. Esto es menos seguro puesto
# que podría hacer que el otro sistema operativo no se pudiera arrancar.
d-i grub-installer/with_other_os boolean true

# Alternativamente, descomente y edite estas líneas
# si desea instalar en una ubicación distinta al MBR:
#d-i grub-installer/bootdev  string (hd0,0)
#d-i grub-installer/only_debian boolean false
#d-i grub-installer/with_other_os boolean false
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-pkgsel">
  <title>Selección de paquetes</title>
<para>

Puede elegir la instalación de cualquier combinación de las tareas que
están disponibles. Las tareas disponibles en el momento de escribir
estas líneas incluyen:

</para>

<itemizedlist>
<listitem><para>
  <userinput>Sistema estándar («standard»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Entorno de escritorio («desktop»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Entorno de escritorio GNOME («gnome-desktop»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Entorno de escritorio KDE («kde-desktop»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor web («web-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor de impresoras («print-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor de DNS («dns-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor de ficheros («file-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Servidor de correos («mail-server»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Base de datos SQL («sql-database»)</userinput>
</para></listitem>
<listitem><para>
  <userinput>Ordenador portátil («laptop»)</userinput>
</para></listitem>
</itemizedlist>

<para>

También puede no seleccionar ninguna tarea y forzar la instalación de un
conjunto de paquetes de alguna otra forma. Le recomendamos que siempre
introduzca la tarea <userinput>Sistema estándar</userinput>.

</para>

<informalexample role="example"><screen>
tasksel tasksel/first multiselect standard, desktop
#tasksel tasksel/first multiselect standard, web-server
#tasksel tasksel/first multiselect standard, kde-desktop

# Algunas verisones del instalador pueden informar de las versiones
# de programas que tiene instalados y los programas que utiliza.
# Por omisión, no se envía ningún informe, pero estos informes
# ayudan al proyecto a determinar qué programas son más populares
# y deben incluirse en los CDs
#popularity-contest popularity-contest/participate boolean false
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-finish">
  <title>Finalizar la primar fase de la instalación</title>

<informalexample role="example"><screen>
# Omitir el mensaje final sobre la finalización de la instalación.
d-i finish-install/reboot_in_progress note

# Esta opción impedirá que el instalador expulse el CD durante 
# el reinicio, y puede ser útil en algunas circunstancias:
#d-i cdrom-detect/eject boolean false
</screen></informalexample>

  </sect2>



  <sect2 id="preseed-mailer">
  <title>Configuración del servicio de correo</title>
<para>

Exim sólo pregunta unas pocas preguntas durante la instalación
normal. Aquí se muestra cómo evitar incluso esas preguntas, aunque es
posible hacer preconfiguraciones más complejtas.

</para>

<informalexample role="example"><screen>
exim4-config exim4/dc_eximconfig_configtype \
       select no configuration at this time
exim4-config exim4/no_config boolean true
exim4-config exim4/no_config boolean true
exim4-config exim4/dc_postmaster string
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-X">
  <title>Configuración de X</title>
<para>

Es posible preconfigurar el entorno de las X en Debian, pero probablemente
necesitará saber algunos detalles sobre el hardware de vídeo de la
máquina puesto que el programa de configuración no efectúa una
configuración totalmente automática de todo.

</para>

<informalexample role="example"><screen>
# X puede detectar el controlador adecuado para algunas tarjetas, pero
# si está preconfigurando puede modificar el que éste elija. Incluso en este caso,
# vesa funcionará para la mayoría del hardware.
#xserver-xorg xserver-xorg/config/device/driver select vesa

# Un problema con la autodetección del ratón es que, si ésta falla, X
# reintentará el proceso una y otra vez. De modo que si se efectúa la preconfiguración,
# existe la posibilidad de que se produzca un bucle infinito si no se autodetecta el ratón.
#xserver-xorg xserver-xorg/autodetect_mouse boolean true

# Se recomienda la autodetección del monitor.
xserver-xorg xserver-xorg/autodetect_monitor boolean true
# Descomente este valor si tiene una pantalla LCD.
#xserver-xorg xserver-xorg/config/monitor/lcd boolean true

# X tiene tres métodos de configuración para el monitor. Ésta es la forma
# de preconfigurar el método «medio», que siempre está disponible. El
# método «simple» podría no estar disponible y el «avanzado» hace
xserver-xorg xserver-xorg/config/monitor/selection-method \
       select medium
xserver-xorg xserver-xorg/config/monitor/mode-list \
       select 1024x768 @ 60 Hz
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-other">
  <title>Preconfiguración de otros paquetes</title>

<informalexample role="example"><screen>
# Dependiendo del software que elija instalar, o si las cosas no salen
# bien durante el proceso de instalación, es posible que se formulen
# otra preguntas. Por supuesto también puede preconfigurar éstas.
# Para obtener una lista de cada pregunta posible que podría llegar a ser
# formulada durante una instalación puede hacer una instalación y
# ejecutar estas órdenes:
#   debconf-get-selections --installer > file
#   debconf-get-selections >> file
</screen></informalexample>

  </sect2>
 </sect1>

 <sect1 id="preseed-advanced">
 <title>Opciones avanzadas</title>

  <sect2 id="preseed-shell">
  <title>Órdenes de shell</title>

<informalexample role="example"><screen>
# La preconfiguración de d-i es inherentemente insegura. Ninguna parte del
# instalador verifica intentos de desbordamiento de buffer u otras
# formas de malversación de los valores de un fichero de preconfiguración
# como éste. ¡Use solamente ficheros de preconfiguración de fuentes
# confiables! Para poder gestionar esto, y porque generalmente es útil,
# a continuación ofrecemos una forma de ejecutar automáticamente cualquier 
# orden de shell que desee dentro del instalador.

# Esta primera orden se ejecuta tan pronto como sea posible, después de que
# se lea el fichero de preconfiguración:
#d-i preseed/early_command string anna-install some-udeb

# Ésta orden se ejecuta justamente antes de que finalice la instalación,
# pero cuando todavía existe un directorio /target usable. Puede
# hacer un chroot a /target y utilizarlo directamente o utilizar las
# órdenes apt-install e «in-target» para instalar fácilmente paquetes
# y ejecutar órdenes en el sistema objetivo
#d-i preseed/late_command string apt-get install zsh; in-target chsh -s /bin/zsh
</screen></informalexample>

  </sect2>

  <sect2 id="preseed-chainload">
  <title>Carga de archivos de configuración en cadena</title>
<para>

Si lo desea puede incluir otros ficheros de preconfiguración en éste.
Cualquier configuración en estos ficheros modificará los valores
preexistentes de este fichero.  Esto permite, por ejemplo, poner la
configuración general de red para su ubicación en un fichero y poner
configuraciones más específicas para algunas configuraciones en otros
ficheros.

</para>

<informalexample><screen>

# Se puede listar más de un fichero, separado por espacios y se cargarán
# todos. Los ficheros incluidos también pueden tener directivas propias
# de preconfiguración o inclusión. Tenga en cuenta que si los nombres de
# fichero son relativos, éstos se toman del mismo directorio donde se
# ubica el fichero que los incluye.
#d-i preseed/include string x.cfg

# El instalador puede, opcionalmente, verificar las sumas de control
# de los ficheros de preconfiguración antes de utilizarlos. De momento
# sólo se pueden utilizar sumas MD5. Debe listar las sumas MD5 en el
# mismo orden en el que lista los ficheros a incluir.
#d-i preseed/include/checksum string 5da499872becccfeda2c4872f9171c3d


# Esta opción es todavía más flexible: se ejecuta una orden de shell y
# se incluyen nuevos ficheros si ésta imprime los nombres de otrs
# ficheros de preconfiguración.
#d-i preseed/include_command \
#      string echo if [ "`hostname`" = bob ]; then echo bob.cfg; fi

# Lo más flexible es descargar un programa y ejecutarlo. El programa
# puede utilizar órdenes como debconf-set para manipular la base de datos
# de debconf. Tenga en cuenta que los nombres de los archivos son relativos,
# se obtienen del mismo directorio donde está el archivo de preconfiguración
# que los ejecuta.
d-i preseed/run string foo.sh
</screen></informalexample>

  </sect2>
 </sect1>
</appendix>
